const QRCode = require('qrcode');
const fs = require('fs');
const path = require('path');

class QRCodeGenerator {
    constructor() {}

    // Creates a qrcode image by req.url
    async imageByUrl(options, callback) {
      try {

        let filename = options.filename;

        if (!filename) {
          filename = 'qr-code.png';
        }
        // Generate a QR code as a Buffer
        const qrCodeBuffer = await QRCode.toBuffer(options.text, { errorCorrectionLevel: 'H' });
    
        // Specify the file path where you want to save the downloaded QR code image
        const filePath = path.join(__dirname, filename);
    
        // Write the Buffer to a file
        fs.writeFileSync(filePath, qrCodeBuffer);
    
        // Call the callback with the file path
        callback(null, filePath);
      } catch (error) {
        console.error('Error generating QR code:', error);
        callback(error);
      }
    }
}

module.exports = QRCodeGenerator;